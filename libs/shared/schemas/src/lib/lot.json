{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "libs/shared/schemas/src/lib/lot.json",
  "title": "Lot",
  "description": "A lot is a collection of batches that share the same processing target state.",
  "type": "object",
  "allOf": [
    {
      "$ref": "#/$defs/LotPartial"
    },
    {
      "title": "LotExtras",
      "type": "object",
      "properties": {
        "batches": {
          "$comment": "batch mix sharing the same processing targetState.",
          "title": "Batches",
          "type": "array",
          "description": "The batches that make up this lot.",
          "items": {
            "oneOf": [
              {
                "$ref": "#/$defs/BatchPartial"
              },
              {
                "title": "CID",
                "type": "string",
                "format": "cid"
              }
            ]
          },
          "uniqueItems": true,
          "minItems": 1,
          "readOnly": true,
          "sameProcessingTargetState": true
        }
      },
      "additionalProperties": true,
      "required": ["batches"]
    }
  ],
  "$defs": {
    "BatchPartial": {
      "$schema": "https://json-schema.org/draft/2020-12/schema",
      "title": "BatchPartial",
      "description": "A batch of coffee is a collection of coffee varieties that are processed together.",
      "type": "object",
      "additionalProperties": true,
      "properties": {
        "id": {
          "type": "string",
          "description": "The batch ID.",
          "format": "uuid"
        },
        "name": {
          "type": "string",
          "description": "The batch name."
        },
        "facility": {
          "description": "organisation or person that is responsible for the processing of the batch",
          "$ref": "#/$defs/BatchPartial/$defs/Contact"
        },
        "processing": {
          "$ref": "#/$defs/BatchPartial/$defs/Processing"
        },
        "varieties": {
          "title": "Varieties",
          "type": "array",
          "items": {
            "$ref": "#/$defs/BatchPartial/$defs/Variety"
          },
          "uniqueItems": true,
          "minItems": 1
        },
        "createdAt": {
          "type": "string",
          "format": "date-time"
        },
        "updatedAt": {
          "type": "string",
          "format": "date-time"
        }
      },
      "required": ["id", "facility", "processing", "varieties"],
      "$defs": {
        "Contact": {
          "$schema": "https://json-schema.org/draft/2020-12/schema",
          "title": "Contact",
          "type": "object",
          "additionalProperties": true,
          "properties": {
            "name": {
              "type": "string",
              "description": "The full name of the contact."
            },
            "firstName": {
              "type": "string"
            },
            "lastName": {
              "type": "string"
            },
            "email": {
              "title": "Email",
              "type": "string",
              "description": "The email address of the contact.",
              "format": "email"
            },
            "website": {
              "title": "Website",
              "type": "string",
              "format": "uri"
            },
            "phone": {
              "title": "Phone",
              "type": "string",
              "description": "The phone number of the contact.",
              "pattern": "^\\+?[1-9]\\d{1,14}$"
            },
            "area": {
              "$ref": "#/$defs/BatchPartial/$defs/Contact/$defs/Area"
            },
            "location": {
              "$ref": "#/$defs/BatchPartial/$defs/Contact/$defs/Location"
            },
            "organizationName": {
              "title": "OrganizationName",
              "type": "string",
              "description": "The name of the company|association the contact works for."
            }
          },
          "required": ["name"],
          "dependentRequired": {
            "firstName": ["lastName"],
            "lastName": ["firstName"],
            "organizationName": ["email", "location"]
          },
          "$defs": {
            "MeasurementAmount": {
              "$ref": "#/$defs/LotPartial/$defs/Weight/$defs/MeasurementAmount"
            },
            "Area": {
              "title": "Area",
              "type": "object",
              "properties": {
                "amount": {
                  "$ref": "#/$defs/LotPartial/$defs/Weight/$defs/MeasurementAmount"
                },
                "unit": {
                  "title": "AreaUnit",
                  "type": "string",
                  "const": "m2",
                  "default": "m2"
                }
              },
              "additionalProperties": false,
              "required": ["amount", "unit"]
            },
            "Location": {
              "$schema": "https://json-schema.org/draft/2020-12/schema",
              "title": "Location",
              "type": "object",
              "properties": {
                "name": {
                  "type": "string"
                },
                "country": {
                  "$ref": "#/$defs/BatchPartial/$defs/Contact/$defs/Location/$defs/Country"
                },
                "state": {
                  "type": "string"
                },
                "region": {
                  "type": "string",
                  "description": "The specific region within the country."
                },
                "subregion": {
                  "type": "string",
                  "description": "The specific subregion within the region."
                },
                "zip": {
                  "type": "string"
                },
                "city": {
                  "type": "string"
                },
                "street": {
                  "type": "string"
                },
                "altitude": {
                  "type": "number",
                  "description": "The altitude in meters."
                },
                "latitude": {
                  "type": "number",
                  "description": "The latitude coordinate."
                },
                "longitude": {
                  "type": "number",
                  "description": "The longitude coordinate."
                }
              },
              "additionalProperties": false,
              "required": ["country"],
              "dependentRequired": {
                "subregion": ["region"],
                "latitude": ["longitude"],
                "longitude": ["latitude"]
              },
              "$defs": {
                "Country": {
                  "$schema": "https://json-schema.org/draft/2020-12/schema",
                  "title": "Country",
                  "type": "string",
                  "description": "The country as ISO code where the coffee is produced.",
                  "enum": [
                    "AF",
                    "AX",
                    "AL",
                    "DZ",
                    "AS",
                    "AD",
                    "AO",
                    "AI",
                    "AQ",
                    "AG",
                    "AR",
                    "AM",
                    "AW",
                    "AU",
                    "AT",
                    "AZ",
                    "BS",
                    "BH",
                    "BD",
                    "BB",
                    "BY",
                    "BE",
                    "BZ",
                    "BJ",
                    "BM",
                    "BT",
                    "BO",
                    "BQ",
                    "BA",
                    "BW",
                    "BV",
                    "BR",
                    "IO",
                    "BN",
                    "BG",
                    "BF",
                    "BI",
                    "CV",
                    "KH",
                    "CM",
                    "CA",
                    "KY",
                    "CF",
                    "TD",
                    "CL",
                    "CN",
                    "CX",
                    "CC",
                    "CO",
                    "KM",
                    "CG",
                    "CD",
                    "CK",
                    "CR",
                    "CI",
                    "HR",
                    "CU",
                    "CW",
                    "CY",
                    "CZ",
                    "DK",
                    "DJ",
                    "DM",
                    "DO",
                    "EC",
                    "EG",
                    "SV",
                    "GQ",
                    "ER",
                    "EE",
                    "SZ",
                    "ET",
                    "FK",
                    "FO",
                    "FJ",
                    "FI",
                    "FR",
                    "GF",
                    "PF",
                    "TF",
                    "GA",
                    "GM",
                    "GE",
                    "DE",
                    "GH",
                    "GI",
                    "GR",
                    "GL",
                    "GD",
                    "GP",
                    "GU",
                    "GT",
                    "GG",
                    "GN",
                    "GW",
                    "GY",
                    "HT",
                    "HM",
                    "VA",
                    "HN",
                    "HK",
                    "HU",
                    "IS",
                    "IN",
                    "ID",
                    "IR",
                    "IQ",
                    "IE",
                    "IM",
                    "IL",
                    "IT",
                    "JM",
                    "JP",
                    "JE",
                    "JO",
                    "KZ",
                    "KE",
                    "KI",
                    "KP",
                    "KR",
                    "KW",
                    "KG",
                    "LA"
                  ]
                }
              },
              "examples": [
                {
                  "name": "Work",
                  "country": "US",
                  "state": "CA",
                  "region": "San Francisco",
                  "subregion": "Mission District",
                  "zip": "94110",
                  "city": "San Francisco",
                  "street": "123 Main St",
                  "altitude": 100,
                  "latitude": 37.7749,
                  "longitude": 122.4194
                },
                {
                  "name": "Home",
                  "country": "FR",
                  "zip": "17000",
                  "city": "La Rochelle",
                  "street": "Place de la Résistance"
                }
              ]
            }
          },
          "examples": [
            {
              "name": "John Doe",
              "email": "email@email.com",
              "phone": "+1234567890",
              "website": "https://example.com",
              "area": {
                "value": 100,
                "unit": "m2"
              },
              "location": {
                "name": "Home",
                "country": "FR",
                "zip": "17000",
                "city": "La Rochelle",
                "street": "Place de la Résistance"
              },
              "organizationName": "Example Inc.",
              "extraProperty": "additionalValue"
            }
          ]
        },
        "Processing": {
          "$schema": "https://json-schema.org/draft/2020-12/schema",
          "title": "Processing",
          "description": "The process of coffee beans transformation.",
          "$comment": "The International Coffee Organization (ICO) the following conversions, dry cherry => green brean : 0.5 ; parchment => green bean : 0.8 ; roasted bean => green bean : 1.19",
          "type": "object",
          "properties": {
            "name": {
              "description": "The name of the process.",
              "type": "string"
            },
            "sourceState": {
              "description": "The incoming state of the coffe.",
              "$ref": "#/$defs/BatchPartial/$defs/Processing/$defs/ProcessingState"
            },
            "sourceWeight": {
              "description": "The incoming weight of the coffe.",
              "$ref": "#/$defs/BatchPartial/$defs/Processing/$defs/Weight"
            },
            "targetState": {
              "description": "The outgoing state of the coffe.",
              "$ref": "#/$defs/BatchPartial/$defs/Processing/$defs/ProcessingState"
            },
            "targetWeight": {
              "description": "The outgoing weight of the coffe.",
              "$ref": "#/$defs/BatchPartial/$defs/Processing/$defs/Weight"
            },
            "start": {
              "description": "The start date of the process.",
              "type": "string",
              "format": "date-time"
            },
            "end": {
              "description": "The end date of the process.",
              "type": "string",
              "format": "date-time"
            },
            "method": {
              "description": "The processing method.",
              "$ref": "#/$defs/BatchPartial/$defs/Processing/$defs/ProcessingMethod"
            }
          },
          "additionalProperties": false,
          "required": [
            "sourceState",
            "sourceWeight",
            "targetState",
            "targetWeight",
            "start",
            "end",
            "method"
          ],
          "$defs": {
            "ProcessingMethod": {
              "$schema": "https://json-schema.org/draft/2020-12/schema",
              "title": "ProcessingMethod",
              "description": "The method used to process the coffee, e.g., washed, natural, or honey.",
              "type": "string",
              "enum": [
                "natural",
                "fully_washed",
                "semi_washed",
                "pulped_natural",
                "honey",
                "carbonic_maceration",
                "wet_hulled",
                "other"
              ]
            },
            "ProcessingState": {
              "$schema": "https://json-schema.org/draft/2020-12/schema",
              "title": "ProcessingState",
              "description": "The coffee state from harvested cherries to green beans.",
              "type": "string",
              "enum": [
                "raw_cherries",
                "dried_cherries",
                "wet_parchment",
                "parchment",
                "wet_green",
                "raw_green",
                "green"
              ]
            },
            "Weight": {
              "$schema": "https://json-schema.org/draft/2020-12/schema",
              "title": "Weight",
              "type": "object",
              "properties": {
                "amount": {
                  "$ref": "#/$defs/BatchPartial/$defs/Processing/$defs/Weight/$defs/MeasurementAmount"
                },
                "unit": {
                  "$ref": "#/$defs/BatchPartial/$defs/Processing/$defs/Weight/$defs/WeightUnit"
                }
              },
              "additionalProperties": false,
              "required": ["amount", "unit"],
              "$defs": {
                "MeasurementAmount": {
                  "$schema": "https://json-schema.org/draft/2020-12/schema",
                  "title": "MeasurementAmount",
                  "type": "number",
                  "description": "The amount of the measurement, 10 digits in total, maximum of 3 digits after decimal point",
                  "multipleOf": 0.001,
                  "maximum": 9999999999
                },
                "WeightUnit": {
                  "$schema": "https://json-schema.org/draft/2020-12/schema",
                  "title": "WeightUnit",
                  "type": "string",
                  "enum": ["g", "kg", "oz", "lb"]
                }
              }
            }
          },
          "examples": [
            {
              "name": "The wash",
              "sourceState": "dried_cherries",
              "sourceWeight": {
                "amount": 10,
                "unit": "kg"
              },
              "targetState": "wet_parchment",
              "targetWeight": {
                "amount": 9,
                "unit": "kg"
              },
              "start": "2021-01-01T00:00:00.000Z",
              "end": "2021-01-01T00:00:00.000Z",
              "method": "fully_washed"
            },
            {
              "name": "Super Roasting",
              "sourceState": "green",
              "sourceWeight": {
                "amount": 1000,
                "unit": "g"
              },
              "targetState": "roasted",
              "targetWeight": {
                "amount": 900,
                "unit": "g"
              },
              "start": "2021-01-01T00:00:00.000Z",
              "end": "2021-01-01T00:00:00.000Z",
              "method": "other"
            }
          ]
        },
        "Variety": {
          "$schema": "https://json-schema.org/draft/2020-12/schema",
          "description": "The coffee bean variety.",
          "title": "Variety",
          "anyOf": [
            {
              "title": "Variety",
              "type": "string",
              "enum": [
                "Agaro",
                "Arusha",
                "Ateng",
                "Batian",
                "Bergandal",
                "Blue Mountain",
                "Bourbon",
                "Castillo",
                "Catimor",
                "Catuai",
                "Caturra",
                "Cauvery",
                "Excelsa",
                "Geisha",
                "Icatu",
                "Jackson",
                "Kent",
                "K7",
                "Laurina",
                "Liberica",
                "Maragogype",
                "Mibrizi",
                "Moka",
                "Mundo Novo",
                "Mysore",
                "N5",
                "N39",
                "Onan Ganjang",
                "Pacamara",
                "Red Bourbon",
                "Ruiru 11",
                "S274",
                "S795",
                "Selection 5B",
                "Selection 6",
                "Selection 9",
                "Selection 10",
                "Sidikalang",
                "SL14",
                "SL28",
                "SL34",
                "SV-2006",
                "Sudan Rume",
                "TimTim",
                "Typica",
                "Typica/Nyara",
                "Yellow Bourbon"
              ]
            },
            {
              "type": "string"
            }
          ]
        }
      },
      "examples": [
        {
          "id": "b1b2b3b4-b5b6-b7b8-b9b0-b1b2b3b4b5b6",
          "name": "Coffee 1",
          "facility": {
            "name": "Washing station",
            "location": {
              "country": "ET"
            }
          },
          "processing": {
            "name": "The wash",
            "sourceState": "dried_cherries",
            "sourceWeight": {
              "amount": 10,
              "unit": "kg"
            },
            "targetState": "wet_parchment",
            "targetWeight": {
              "amount": 9,
              "unit": "kg"
            },
            "start": "2021-01-01T00:00:00.000Z",
            "end": "2021-01-01T00:00:00.000Z",
            "method": "fully_washed"
          },
          "varieties": ["Heirloom"],
          "createdAt": "2021-01-01T00:00:00Z",
          "updatedAt": "2021-01-01T00:00:00Z"
        }
      ]
    },
    "LotPartial": {
      "$schema": "https://json-schema.org/draft/2020-12/schema",
      "title": "LotPartial",
      "description": "A coffee lot is a collection of coffee batches that are processed together. A lot is the smallest unit of coffee that can be sold.",
      "type": "object",
      "additionalProperties": true,
      "properties": {
        "id": {
          "type": "string",
          "description": "The lot ID.",
          "format": "uuid"
        },
        "arrivalDate": {
          "type": "string",
          "format": "date-time"
        },
        "certifications": {
          "title": "Certifications",
          "type": "array",
          "description": "A list of certifications the coffee holds, e.g., 'Organic', 'Fair Trade', or 'Rainforest Alliance'.",
          "items": {
            "$ref": "#/$defs/LotPartial/$defs/Certification"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "countriesOfOrigin": {
          "$comment": "computed value of all unique countries of facilities processing the batches.",
          "title": "AggregatedCountriesOfOrigin",
          "type": "array",
          "items": {
            "$ref": "#/$defs/LotPartial/$defs/BatchPartial/$defs/Contact/$defs/Location/$defs/Country"
          },
          "readOnly": true,
          "default": [],
          "uniqueItems": true,
          "jsonata": "$distinct([batches.facility.location.country])"
        },
        "expectedWeight": {
          "$comment": "computed value of the aggregated target weight of the batches",
          "oneOf": [
            {
              "$ref": "#/$defs/LotPartial/$defs/Weight"
            },
            {
              "title": "Null",
              "type": "null"
            }
          ],
          "readOnly": true,
          "default": null,
          "jsonata": "batches.processing.targetWeight{'weight': { 'amount': $round($sum($.(unit = 'kg' ? amount : unit = 'g' ? amount / 1000 : unit = 'lb' ? amount * 0.453592 : unit = 'oz' ? amount * 0.0283495)), 3), 'unit': 'kg'}}"
        },
        "metadata": {
          "$ref": "#/$defs/LotPartial/$defs/Metadata"
        },
        "processingMethods": {
          "$comment": "computed value of all methods used to transform coffee batches.",
          "title": "AggregatedProcessingMethods",
          "type": "array",
          "items": {
            "$ref": "#/$defs/LotPartial/$defs/BatchPartial/$defs/Processing/$defs/ProcessingMethod"
          },
          "readOnly": true,
          "default": [],
          "uniqueItems": true,
          "jsonata": "$distinct([batches.processing.method])"
        },
        "sourceWeight": {
          "$comment": "computed value of the aggregated weight of the batches sources, grouped by processing state.",
          "oneOf": [
            {
              "$ref": "#/$defs/LotPartial/$defs/AgreggateWeight"
            },
            {
              "title": "Null",
              "type": "null"
            }
          ],
          "readOnly": true,
          "default": null,
          "jsonata": "batches.processing{sourceState: {'weight': {'amount': $round($sum($.sourceWeight.(unit = 'kg' ? amount : unit = 'g' ? amount / 1000 : unit = 'lb' ? amount * 0.453592 : unit = 'oz' ? amount * 0.0283495)), 3),'unit': 'kg'}}}"
        },
        "step": {
          "description": "The current transformation step of the coffee lot.",
          "$ref": "#/$defs/LotPartial/$defs/Step"
        },
        "varieties": {
          "title": "AggregatedVarieties",
          "$comment": "computed value of all varieties contained in batches.",
          "type": "array",
          "items": {
            "title": "Varieties",
            "type": "array",
            "items": {
              "$ref": "#/$defs/LotPartial/$defs/BatchPartial/$defs/Variety"
            },
            "uniqueItems": true
          },
          "readOnly": true,
          "default": [],
          "jsonata": "[batches.[varieties]]"
        },
        "createdAt": {
          "type": "string",
          "format": "date-time"
        },
        "updatedAt": {
          "type": "string",
          "format": "date-time"
        }
      },
      "required": ["id", "step"],
      "$defs": {
        "AgreggateWeight": {
          "title": "AggregateWeight",
          "type": "object",
          "propertyNames": {
            "$ref": "#/$defs/LotPartial/$defs/Step"
          },
          "patternProperties": {
            "": {
              "$ref": "#/$defs/LotPartial/$defs/Weight"
            }
          },
          "examples": [
            {
              "green": {
                "amount": 100,
                "unit": "kg"
              },
              "roasted": {
                "amount": 100,
                "unit": "kg"
              }
            }
          ]
        },
        "BatchPartial": {
          "$schema": "https://json-schema.org/draft/2020-12/schema",
          "title": "BatchPartial",
          "description": "A batch of coffee is a collection of coffee varieties that are processed together.",
          "type": "object",
          "additionalProperties": true,
          "properties": {
            "id": {
              "type": "string",
              "description": "The batch ID.",
              "format": "uuid"
            },
            "name": {
              "type": "string",
              "description": "The batch name."
            },
            "facility": {
              "description": "organisation or person that is responsible for the processing of the batch",
              "$ref": "#/$defs/LotPartial/$defs/BatchPartial/$defs/Contact"
            },
            "processing": {
              "$ref": "#/$defs/LotPartial/$defs/BatchPartial/$defs/Processing"
            },
            "varieties": {
              "title": "Varieties",
              "type": "array",
              "items": {
                "$ref": "#/$defs/LotPartial/$defs/BatchPartial/$defs/Variety"
              },
              "uniqueItems": true,
              "minItems": 1
            },
            "createdAt": {
              "type": "string",
              "format": "date-time"
            },
            "updatedAt": {
              "type": "string",
              "format": "date-time"
            }
          },
          "required": ["id", "facility", "processing", "varieties"],
          "$defs": {
            "Contact": {
              "$schema": "https://json-schema.org/draft/2020-12/schema",
              "title": "Contact",
              "type": "object",
              "additionalProperties": true,
              "properties": {
                "name": {
                  "type": "string",
                  "description": "The full name of the contact."
                },
                "firstName": {
                  "type": "string"
                },
                "lastName": {
                  "type": "string"
                },
                "email": {
                  "title": "Email",
                  "type": "string",
                  "description": "The email address of the contact.",
                  "format": "email"
                },
                "website": {
                  "title": "Website",
                  "type": "string",
                  "format": "uri"
                },
                "phone": {
                  "title": "Phone",
                  "type": "string",
                  "description": "The phone number of the contact.",
                  "pattern": "^\\+?[1-9]\\d{1,14}$"
                },
                "area": {
                  "$ref": "#/$defs/LotPartial/$defs/BatchPartial/$defs/Contact/$defs/Area"
                },
                "location": {
                  "$ref": "#/$defs/LotPartial/$defs/BatchPartial/$defs/Contact/$defs/Location"
                },
                "organizationName": {
                  "title": "OrganizationName",
                  "type": "string",
                  "description": "The name of the company|association the contact works for."
                }
              },
              "required": ["name"],
              "dependentRequired": {
                "firstName": ["lastName"],
                "lastName": ["firstName"],
                "organizationName": ["email", "location"]
              },
              "$defs": {
                "MeasurementAmount": {
                  "$ref": "#/$defs/BatchPartial/$defs/Processing/$defs/Weight/$defs/MeasurementAmount"
                },
                "Area": {
                  "title": "Area",
                  "type": "object",
                  "properties": {
                    "amount": {
                      "$ref": "#/$defs/BatchPartial/$defs/Processing/$defs/Weight/$defs/MeasurementAmount"
                    },
                    "unit": {
                      "title": "AreaUnit",
                      "type": "string",
                      "const": "m2",
                      "default": "m2"
                    }
                  },
                  "additionalProperties": false,
                  "required": ["amount", "unit"]
                },
                "Location": {
                  "$schema": "https://json-schema.org/draft/2020-12/schema",
                  "title": "Location",
                  "type": "object",
                  "properties": {
                    "name": {
                      "type": "string"
                    },
                    "country": {
                      "$ref": "#/$defs/LotPartial/$defs/BatchPartial/$defs/Contact/$defs/Location/$defs/Country"
                    },
                    "state": {
                      "type": "string"
                    },
                    "region": {
                      "type": "string",
                      "description": "The specific region within the country."
                    },
                    "subregion": {
                      "type": "string",
                      "description": "The specific subregion within the region."
                    },
                    "zip": {
                      "type": "string"
                    },
                    "city": {
                      "type": "string"
                    },
                    "street": {
                      "type": "string"
                    },
                    "altitude": {
                      "type": "number",
                      "description": "The altitude in meters."
                    },
                    "latitude": {
                      "type": "number",
                      "description": "The latitude coordinate."
                    },
                    "longitude": {
                      "type": "number",
                      "description": "The longitude coordinate."
                    }
                  },
                  "additionalProperties": false,
                  "required": ["country"],
                  "dependentRequired": {
                    "subregion": ["region"],
                    "latitude": ["longitude"],
                    "longitude": ["latitude"]
                  },
                  "$defs": {
                    "Country": {
                      "$schema": "https://json-schema.org/draft/2020-12/schema",
                      "title": "Country",
                      "type": "string",
                      "description": "The country as ISO code where the coffee is produced.",
                      "enum": [
                        "AF",
                        "AX",
                        "AL",
                        "DZ",
                        "AS",
                        "AD",
                        "AO",
                        "AI",
                        "AQ",
                        "AG",
                        "AR",
                        "AM",
                        "AW",
                        "AU",
                        "AT",
                        "AZ",
                        "BS",
                        "BH",
                        "BD",
                        "BB",
                        "BY",
                        "BE",
                        "BZ",
                        "BJ",
                        "BM",
                        "BT",
                        "BO",
                        "BQ",
                        "BA",
                        "BW",
                        "BV",
                        "BR",
                        "IO",
                        "BN",
                        "BG",
                        "BF",
                        "BI",
                        "CV",
                        "KH",
                        "CM",
                        "CA",
                        "KY",
                        "CF",
                        "TD",
                        "CL",
                        "CN",
                        "CX",
                        "CC",
                        "CO",
                        "KM",
                        "CG",
                        "CD",
                        "CK",
                        "CR",
                        "CI",
                        "HR",
                        "CU",
                        "CW",
                        "CY",
                        "CZ",
                        "DK",
                        "DJ",
                        "DM",
                        "DO",
                        "EC",
                        "EG",
                        "SV",
                        "GQ",
                        "ER",
                        "EE",
                        "SZ",
                        "ET",
                        "FK",
                        "FO",
                        "FJ",
                        "FI",
                        "FR",
                        "GF",
                        "PF",
                        "TF",
                        "GA",
                        "GM",
                        "GE",
                        "DE",
                        "GH",
                        "GI",
                        "GR",
                        "GL",
                        "GD",
                        "GP",
                        "GU",
                        "GT",
                        "GG",
                        "GN",
                        "GW",
                        "GY",
                        "HT",
                        "HM",
                        "VA",
                        "HN",
                        "HK",
                        "HU",
                        "IS",
                        "IN",
                        "ID",
                        "IR",
                        "IQ",
                        "IE",
                        "IM",
                        "IL",
                        "IT",
                        "JM",
                        "JP",
                        "JE",
                        "JO",
                        "KZ",
                        "KE",
                        "KI",
                        "KP",
                        "KR",
                        "KW",
                        "KG",
                        "LA"
                      ]
                    }
                  },
                  "examples": [
                    {
                      "name": "Work",
                      "country": "US",
                      "state": "CA",
                      "region": "San Francisco",
                      "subregion": "Mission District",
                      "zip": "94110",
                      "city": "San Francisco",
                      "street": "123 Main St",
                      "altitude": 100,
                      "latitude": 37.7749,
                      "longitude": 122.4194
                    },
                    {
                      "name": "Home",
                      "country": "FR",
                      "zip": "17000",
                      "city": "La Rochelle",
                      "street": "Place de la Résistance"
                    }
                  ]
                }
              },
              "examples": [
                {
                  "name": "John Doe",
                  "email": "email@email.com",
                  "phone": "+1234567890",
                  "website": "https://example.com",
                  "area": {
                    "value": 100,
                    "unit": "m2"
                  },
                  "location": {
                    "name": "Home",
                    "country": "FR",
                    "zip": "17000",
                    "city": "La Rochelle",
                    "street": "Place de la Résistance"
                  },
                  "organizationName": "Example Inc.",
                  "extraProperty": "additionalValue"
                }
              ]
            },
            "Processing": {
              "$schema": "https://json-schema.org/draft/2020-12/schema",
              "title": "Processing",
              "description": "The process of coffee beans transformation.",
              "$comment": "The International Coffee Organization (ICO) the following conversions, dry cherry => green brean : 0.5 ; parchment => green bean : 0.8 ; roasted bean => green bean : 1.19",
              "type": "object",
              "properties": {
                "name": {
                  "description": "The name of the process.",
                  "type": "string"
                },
                "sourceState": {
                  "description": "The incoming state of the coffe.",
                  "$ref": "#/$defs/LotPartial/$defs/BatchPartial/$defs/Processing/$defs/ProcessingState"
                },
                "sourceWeight": {
                  "description": "The incoming weight of the coffe.",
                  "$ref": "#/$defs/LotPartial/$defs/BatchPartial/$defs/Processing/$defs/Weight"
                },
                "targetState": {
                  "description": "The outgoing state of the coffe.",
                  "$ref": "#/$defs/LotPartial/$defs/BatchPartial/$defs/Processing/$defs/ProcessingState"
                },
                "targetWeight": {
                  "description": "The outgoing weight of the coffe.",
                  "$ref": "#/$defs/LotPartial/$defs/BatchPartial/$defs/Processing/$defs/Weight"
                },
                "start": {
                  "description": "The start date of the process.",
                  "type": "string",
                  "format": "date-time"
                },
                "end": {
                  "description": "The end date of the process.",
                  "type": "string",
                  "format": "date-time"
                },
                "method": {
                  "description": "The processing method.",
                  "$ref": "#/$defs/LotPartial/$defs/BatchPartial/$defs/Processing/$defs/ProcessingMethod"
                }
              },
              "additionalProperties": false,
              "required": [
                "sourceState",
                "sourceWeight",
                "targetState",
                "targetWeight",
                "start",
                "end",
                "method"
              ],
              "$defs": {
                "ProcessingMethod": {
                  "$schema": "https://json-schema.org/draft/2020-12/schema",
                  "title": "ProcessingMethod",
                  "description": "The method used to process the coffee, e.g., washed, natural, or honey.",
                  "type": "string",
                  "enum": [
                    "natural",
                    "fully_washed",
                    "semi_washed",
                    "pulped_natural",
                    "honey",
                    "carbonic_maceration",
                    "wet_hulled",
                    "other"
                  ]
                },
                "ProcessingState": {
                  "$schema": "https://json-schema.org/draft/2020-12/schema",
                  "title": "ProcessingState",
                  "description": "The coffee state from harvested cherries to green beans.",
                  "type": "string",
                  "enum": [
                    "raw_cherries",
                    "dried_cherries",
                    "wet_parchment",
                    "parchment",
                    "wet_green",
                    "raw_green",
                    "green"
                  ]
                },
                "Weight": {
                  "$schema": "https://json-schema.org/draft/2020-12/schema",
                  "title": "Weight",
                  "type": "object",
                  "properties": {
                    "amount": {
                      "$ref": "#/$defs/LotPartial/$defs/BatchPartial/$defs/Processing/$defs/Weight/$defs/MeasurementAmount"
                    },
                    "unit": {
                      "$ref": "#/$defs/LotPartial/$defs/BatchPartial/$defs/Processing/$defs/Weight/$defs/WeightUnit"
                    }
                  },
                  "additionalProperties": false,
                  "required": ["amount", "unit"],
                  "$defs": {
                    "MeasurementAmount": {
                      "$schema": "https://json-schema.org/draft/2020-12/schema",
                      "title": "MeasurementAmount",
                      "type": "number",
                      "description": "The amount of the measurement, 10 digits in total, maximum of 3 digits after decimal point",
                      "multipleOf": 0.001,
                      "maximum": 9999999999
                    },
                    "WeightUnit": {
                      "$schema": "https://json-schema.org/draft/2020-12/schema",
                      "title": "WeightUnit",
                      "type": "string",
                      "enum": ["g", "kg", "oz", "lb"]
                    }
                  }
                }
              },
              "examples": [
                {
                  "name": "The wash",
                  "sourceState": "dried_cherries",
                  "sourceWeight": {
                    "amount": 10,
                    "unit": "kg"
                  },
                  "targetState": "wet_parchment",
                  "targetWeight": {
                    "amount": 9,
                    "unit": "kg"
                  },
                  "start": "2021-01-01T00:00:00.000Z",
                  "end": "2021-01-01T00:00:00.000Z",
                  "method": "fully_washed"
                },
                {
                  "name": "Super Roasting",
                  "sourceState": "green",
                  "sourceWeight": {
                    "amount": 1000,
                    "unit": "g"
                  },
                  "targetState": "roasted",
                  "targetWeight": {
                    "amount": 900,
                    "unit": "g"
                  },
                  "start": "2021-01-01T00:00:00.000Z",
                  "end": "2021-01-01T00:00:00.000Z",
                  "method": "other"
                }
              ]
            },
            "Variety": {
              "$schema": "https://json-schema.org/draft/2020-12/schema",
              "description": "The coffee bean variety.",
              "title": "Variety",
              "anyOf": [
                {
                  "title": "Variety",
                  "type": "string",
                  "enum": [
                    "Agaro",
                    "Arusha",
                    "Ateng",
                    "Batian",
                    "Bergandal",
                    "Blue Mountain",
                    "Bourbon",
                    "Castillo",
                    "Catimor",
                    "Catuai",
                    "Caturra",
                    "Cauvery",
                    "Excelsa",
                    "Geisha",
                    "Icatu",
                    "Jackson",
                    "Kent",
                    "K7",
                    "Laurina",
                    "Liberica",
                    "Maragogype",
                    "Mibrizi",
                    "Moka",
                    "Mundo Novo",
                    "Mysore",
                    "N5",
                    "N39",
                    "Onan Ganjang",
                    "Pacamara",
                    "Red Bourbon",
                    "Ruiru 11",
                    "S274",
                    "S795",
                    "Selection 5B",
                    "Selection 6",
                    "Selection 9",
                    "Selection 10",
                    "Sidikalang",
                    "SL14",
                    "SL28",
                    "SL34",
                    "SV-2006",
                    "Sudan Rume",
                    "TimTim",
                    "Typica",
                    "Typica/Nyara",
                    "Yellow Bourbon"
                  ]
                },
                {
                  "type": "string"
                }
              ]
            }
          },
          "examples": [
            {
              "id": "b1b2b3b4-b5b6-b7b8-b9b0-b1b2b3b4b5b6",
              "name": "Coffee 1",
              "facility": {
                "name": "Washing station",
                "location": {
                  "country": "ET"
                }
              },
              "processing": {
                "name": "The wash",
                "sourceState": "dried_cherries",
                "sourceWeight": {
                  "amount": 10,
                  "unit": "kg"
                },
                "targetState": "wet_parchment",
                "targetWeight": {
                  "amount": 9,
                  "unit": "kg"
                },
                "start": "2021-01-01T00:00:00.000Z",
                "end": "2021-01-01T00:00:00.000Z",
                "method": "fully_washed"
              },
              "varieties": ["Heirloom"],
              "createdAt": "2021-01-01T00:00:00Z",
              "updatedAt": "2021-01-01T00:00:00Z"
            }
          ]
        },
        "Certification": {
          "$schema": "https://json-schema.org/draft/2020-12/schema",
          "description": "A schema describing supply chain certification.",
          "title": "Certification",
          "anyOf": [
            {
              "title": "Certification",
              "type": "string",
              "enum": [
                "Fairtrade",
                "Fair Trade International",
                "Fair for Life",
                "Rainforest Alliance",
                "Organic",
                "Bird Friendly",
                "Direct Trade",
                "UTZ Certified"
              ]
            },
            {
              "type": "string"
            }
          ],
          "examples": ["Fairtrade"]
        },
        "Country": {
          "$ref": "#/$defs/LotPartial/$defs/BatchPartial/$defs/Contact/$defs/Location/$defs/Country"
        },
        "Metadata": {
          "$schema": "https://json-schema.org/draft/2020-12/schema",
          "title": "Metadata",
          "description": "A schema storing schema metadata",
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "created": {
              "type": "string",
              "format": "date-time",
              "description": "The date and time when the coffee information was first created."
            },
            "lastUpdated": {
              "type": "string",
              "format": "date-time",
              "description": "The date and time when the coffee information was last updated."
            },
            "license": {
              "type": "string",
              "description": "The type of license under which the coffee information is published.",
              "const": "Creative Commons Attribution 4.0 International (CC BY 4.0)"
            },
            "resourcePattern": {
              "type": "string",
              "description": "The naming convention pattern for related resources. It can be used to map resources on a static server.",
              "examples": [
                "{resourceType}/{version}/{resourceName}.{extension}"
              ]
            },
            "source": {
              "type": "string",
              "description": "A reference to the primary source of the coffee information, such as a URL or a citation."
            },
            "state": {
              "$ref": "#/$defs/LotPartial/$defs/Metadata/$defs/MetadataState"
            },
            "version": {
              "$ref": "#/$defs/LotPartial/$defs/Metadata/$defs/Version"
            }
          },
          "required": ["version"],
          "dependentRequired": {
            "state": ["created", "lastUpdated"],
            "created": ["state", "lastUpdated"],
            "lastUpdated": ["state", "created"],
            "license": ["author"]
          },
          "$defs": {
            "MetadataState": {
              "title": "MetadataState",
              "type": "string",
              "description": "The state of the coffee information.",
              "enum": ["draft", "published", "archived"]
            },
            "Version": {
              "title": "Version",
              "type": "string",
              "description": "The version of the schema.",
              "pattern": "^\\d+\\.\\d+\\.\\d+$"
            }
          }
        },
        "ProcessingMethod": {
          "$ref": "#/$defs/LotPartial/$defs/BatchPartial/$defs/Processing/$defs/ProcessingMethod"
        },
        "Step": {
          "$schema": "https://json-schema.org/draft/2020-12/schema",
          "title": "ProcessingStep",
          "$comment": "raw cherries - dried cherries - not screened and sorted yet - sorted - as traded and shipped - roasted - blended .",
          "description": "The coffee transformation's chain step.",
          "type": "string",
          "enum": [
            "harvest",
            "dry_cherry",
            "parchment",
            "raw_green",
            "green",
            "roasting",
            "blending"
          ]
        },
        "Variety": {
          "$ref": "#/$defs/LotPartial/$defs/BatchPartial/$defs/Variety"
        },
        "Weight": {
          "$schema": "https://json-schema.org/draft/2020-12/schema",
          "title": "Weight",
          "type": "object",
          "properties": {
            "amount": {
              "$ref": "#/$defs/LotPartial/$defs/Weight/$defs/MeasurementAmount"
            },
            "unit": {
              "$ref": "#/$defs/LotPartial/$defs/Weight/$defs/WeightUnit"
            }
          },
          "additionalProperties": false,
          "required": ["amount", "unit"],
          "$defs": {
            "MeasurementAmount": {
              "$schema": "https://json-schema.org/draft/2020-12/schema",
              "title": "MeasurementAmount",
              "type": "number",
              "description": "The amount of the measurement, 10 digits in total, maximum of 3 digits after decimal point",
              "multipleOf": 0.001,
              "maximum": 9999999999
            },
            "WeightUnit": {
              "$schema": "https://json-schema.org/draft/2020-12/schema",
              "title": "WeightUnit",
              "type": "string",
              "enum": ["g", "kg", "oz", "lb"]
            }
          }
        },
        "WeightUnit": {
          "$schema": "https://json-schema.org/draft/2020-12/schema",
          "title": "WeightUnit",
          "type": "string",
          "enum": ["g", "kg", "oz", "lb"]
        }
      }
    }
  }
}
